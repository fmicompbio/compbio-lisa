<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Binned Motif Enrichment Analysis and Visualization • monaLisa</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Binned Motif Enrichment Analysis and Visualization">
<meta property="og:description" content="Useful functions to work with sequence motifs in the analysis of 
    genomics data. These include methods to annotate genomic regions or 
    sequences with predicted motif hits and to identify motifs that drive 
    observed changes in accessibility or expression. Functions to produce 
    informative visualizations of the obtained results are also provided. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">monaLisa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/monaLisa.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/monaLisa.html">Binned motif enrichment analysis</a>
    </li>
    <li>
      <a href="articles/selecting_motifs_with_randLassoStabSel.Rmd">Identifying motifs by stability selection</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fmicompbio/monaLisa">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<p><img src="articles/monaLisa_logo_v1.png" align="right" alt="monaLisa" width="200px"></p>
<p><br></p>
<div id="monalisa-motif-analysis-with-lisa" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#monalisa-motif-analysis-with-lisa" class="anchor" aria-hidden="true"></a><code>monaLisa</code>: MOtif aNAlysis with Lisa</h1></div>
<p><br></p>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor" aria-hidden="true"></a>Overview</h2>
<p><code>monaLisa</code> was inspired by her father <a href="http://homer.ucsd.edu/homer/index.html" class="external-link">Homer</a> to look for enriched motifs in sets (bins) of genomic regions, compared to all other regions (“binned motif enrichment analysis”).</p>
<p>It uses known motifs representing transcription factor binding preferences, for example for the <code>JASPAR2020</code> Bioconductor package. The regions are for example promoters or accessible regions, which are grouped into bins according to a numerical value assigned to each region, such as change of expression or accessibility. The goal of the analysis is to identify transcription factors that are associated to that numerical value and thus candidates to be drivers in the underlying biological process.</p>
<p>In addition to the “binned motif enrichment analysis”, <code>monaLisa</code> can also be used to address the above question using stability selection (a form of linear regression), or to look for motif matches in sequences.</p>
<p>Current contributors include:</p>
<ul>
<li><a href="https://github.com/mbstadler" class="external-link">Michael Stadler</a></li>
<li><a href="https://github.com/machlabd" class="external-link">Dania Machlab</a></li>
<li><a href="https://github.com/LukasBurger" class="external-link">Lukas Burger</a></li>
<li><a href="https://github.com/csoneson" class="external-link">Charlotte Soneson</a></li>
</ul>
</div>
<div id="functionality" class="section level2">
<h2 class="hasAnchor">
<a href="#functionality" class="anchor" aria-hidden="true"></a>Functionality</h2>
<p>Here is a minimal example to run a <code>monaLisa</code> analysis:</p>
<pre><code><a href="https://rdrr.io/r/base/library.html" class="external-link">library(monaLisa)

mcparams &lt;- BiocParallel::MulticoreParam(10L)
se &lt;- calcBinnedMotifEnrR(seqs = seqs,   # DNAStringSet (e.g. peak sequences)
                          bins = bins,   # factor that groups 'seqs'
                          pwmL = pwms, # PWMatrixList (know motifs)
                          BPPARAM = mcparams,
                          min.score = 10,
                          verbose = TRUE)</a></code></pre>
<p>The return value <code>se</code> is a <code>SummarizedExperiment</code> with motifs in rows and bins in columns, and multiple assays with significance and magnitude of the enrichments.</p>
<p>The inputs for <code>calcBinnedMotifEnrR</code> can be easily obtained using other Bioconductor packages:</p>
<pre><code><a href="https://bioconductor.org/packages/Biostrings" class="external-link"># get sequences ('atacPeaks' is a GRanges)
library(Biostrings)
library(BSgenome.Mmusculus.UCSC.mm10)
seqs &lt;- getSeq(BSgenome.Mmusculus.UCSC.mm10, atacPeaks)

# bin sequences ('atacPeaksChange' is a numerical vector)
bins &lt;- monaLisa::bin(x = atacPeaksChange, binmode = "equalN", nElement = 400)

# obtain known motifs from Jaspar
library(JASPAR2020)
library(TFBSTools)
pwms &lt;- getMatrixSet(JASPAR2020, list(matrixtype = "PWM", tax_group = "vertebrates"))</a></code></pre>
<p>The results can be conveniently visualized:</p>
<pre><code>plotBinDensity(atacPeaksChange, bins, legend = FALSE)</code></pre>
<p><img src="reference/figures/monaLisa_binning_small.png" align="center" alt="binning" width="412px"></p>
<pre><code>plotMotifHeatmaps(se, cluster = TRUE,
                  which.plots = c("enr", "FDR"),
                  show_seqlogo = TRUE)</code></pre>
<p><img src="reference/figures/monaLisa_heatmaps_small.png" align="center" alt="heatmaps" width="501px"></p>
<!-- badges: start -->

</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>


<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://github.com/machlabd">Dania Machlab</a> <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-2578-6930" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>
<a href="https://github.com/LukasBurger">Lukas Burger</a> <br><small class="roles"> Author </small>  </li>
<li>
<a href="https://github.com/csoneson">Charlotte Soneson</a> <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-3833-2169" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>
<a href="https://github.com/mbstadler">Michael Stadler</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-2269-4934" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/fmicompbio/monaLisa/actions" class="external-link"><img src="https://github.com/fmicompbio/monaLisa/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://codecov.io/github/fmicompbio/monaLisa" class="external-link"><img src="https://codecov.io/github/fmicompbio/monaLisa/coverage.svg?branch=master" alt="Codecov.io coverage status"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://github.com/machlabd" class="external-link">Dania Machlab</a>, <a href="https://github.com/LukasBurger" class="external-link">Lukas Burger</a>, <a href="https://github.com/csoneson" class="external-link">Charlotte Soneson</a>, <a href="https://github.com/mbstadler" class="external-link">Michael Stadler</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

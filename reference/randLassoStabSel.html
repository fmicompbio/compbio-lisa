<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Randomized Lasso Stability Selection — randLassoStabSel • monaLisa</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Randomized Lasso Stability Selection — randLassoStabSel"><meta name="description" content="This function runs randomized lasso stability selection as
    presented by Meinshausen and Bühlmann (2010) and with the improved
    error bounds introduced by Shah and Samworth (2013). The function
    uses the stabsel function from the stabs
    package, but implements the randomized lasso version."><meta property="og:description" content="This function runs randomized lasso stability selection as
    presented by Meinshausen and Bühlmann (2010) and with the improved
    error bounds introduced by Shah and Samworth (2013). The function
    uses the stabsel function from the stabs
    package, but implements the randomized lasso version."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">monaLisa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.11.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/monaLisa.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/monaLisa.html">Binned motif enrichment analysis</a></li>
    <li><a class="dropdown-item" href="../articles/selecting_motifs_with_randLassoStabSel.html">Identifying motifs by stability selection</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/fmicompbio/monaLisa"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Randomized Lasso Stability Selection</h1>
      <small class="dont-index">Source: <a href="https://github.com/fmicompbio/monaLisa/blob/devel/R/stability_selection.R" class="external-link"><code>R/stability_selection.R</code></a></small>
      <div class="d-none name"><code>randLassoStabSel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function runs randomized lasso stability selection as
    presented by Meinshausen and Bühlmann (2010) and with the improved
    error bounds introduced by Shah and Samworth (2013). The function
    uses the <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code> function from the <code>stabs</code>
    package, but implements the randomized lasso version.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">randLassoStabSel</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  weakness <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  cutoff <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  PFER <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  mc.cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>the predictor matrix.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>the response vector.</p></dd>


<dt id="arg-weakness">weakness<a class="anchor" aria-label="anchor" href="#arg-weakness"></a></dt>
<dd><p>value between 0 and 1 (default = 0.8).
It affects how strict the method will be in selecting predictors. The
closer it is to 0, the more stringent the selection. A weakness value
of 1 is identical to performing lasso stability selection (not the
randomized version).</p></dd>


<dt id="arg-cutoff">cutoff<a class="anchor" aria-label="anchor" href="#arg-cutoff"></a></dt>
<dd><p>value between 0 and 1 (default = 0.8) which is the cutoff
for the selection probability. Any variable with a selection probability
that is higher than the set cutoff will be selected.</p></dd>


<dt id="arg-pfer">PFER<a class="anchor" aria-label="anchor" href="#arg-pfer"></a></dt>
<dd><p>integer (default = 2) representing the absolute number of
false positives that we allow for in the final list of selected
variables. For details see Meinshausen and Bühlmann (2010).</p></dd>


<dt id="arg-mc-cores">mc.cores<a class="anchor" aria-label="anchor" href="#arg-mc-cores"></a></dt>
<dd><p>integer (default = 1) specifying the number of cores to
use in <code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">mclapply</a></code>, which is the default way
<code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code> does parallelization.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional parameters that can be passed on to
<code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>SummarizedExperiment</code> object where the rows are the
    observations and the columns the predictors (same dimnames as the
    predictor matrix <code>x</code>).
    It contains:</p><dl><dt>assays</dt>
<dd><p>:</p><dl><dt>x</dt>
<dd><p>: the predictor matrix.</p></dd>


</dl><p></p></dd>

      <dt>rowData</dt>
<dd><p>: a DataFrame with columns:</p><dl><dt>y</dt>
<dd><p>: the response vector.</p></dd>


</dl><p></p></dd>

      <dt>colData</dt>
<dd><p>: a DataFrame with columns:</p><dl><dt>selProb</dt>
<dd><p>: the final selection probabilities for the
          predictors (from the last regularization step).</p></dd>

        <dt>selected</dt>
<dd><p>: logical indicating the predictors that made
          the selection with the specified cutoff.</p></dd>

        <dt>selAUC</dt>
<dd><p>: the normalized area under the seletion curve
          (mean of selection probabilities over regulatization steps).</p></dd>

        <dt>reg'<code>i</code>'</dt>
<dd><p>: columns containing the selection
          probabilities for regularization step i.</p></dd>


</dl><p></p></dd>

      <dt>metadata</dt>
<dd><p>: a list of output returned from
        <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code> and <code>randLassoStabSel</code>:</p><dl><dt>stabsel.params.cutoff</dt>
<dd><p>: probability cutoff set for selection
          of predictors (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>

        <dt>stabsel.params.selected</dt>
<dd><p>: elements with maximal selection
          probability greater <code>cutoff</code>
          (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>

        <dt>stabsel.params.max</dt>
<dd><p>: maximum of selection probabilities
          (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>

        <dt>stabsel.params.q</dt>
<dd><p>: average number of selected variables
          used (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>

        <dt>stabsel.params.PFER</dt>
<dd><p>: (realized) upper bound for the
          per-family error rate (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>

        <dt>stabsel.params.specifiedPFER</dt>
<dd><p>: specified upper bound for
          the per-family error rate (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>

        <dt>stabsel.params.p</dt>
<dd><p>: the number of effects subject to
          selection (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>

        <dt>stabsel.params.B</dt>
<dd><p>: the number of subsamples (see
          <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>

        <dt>stabsel.params.sampling.type</dt>
<dd><p>: the sampling type used for
          stability selection (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>

        <dt>stabsel.params.assumption</dt>
<dd><p>: the assumptions made on the
          selection probabilities (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>

        <dt>stabsel.params.call</dt>
<dd><p>: <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code> the call.</p></dd>

        <dt>randStabsel.params.weakness</dt>
<dd><p>: the weakness parameter in the
          randomized lasso stability selection.</p></dd>


</dl><p></p></dd>



</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Randomized lasso stability selection runs a randomized lasso
    regression several times on subsamples of the response variable and
    predictor matrix. N/2 elements from the response variable are randomly
    chosen in each regression, where N is the length of the vector. The
    corresponding section of the predictor matrix is also chosen, and the
    internal <code>.glmnetRandomizedLasso</code> function is applied.
    Stability selection results in selection probabilities for each
    predictor. The probability of a specific predictor is the number of
    times it was selected divided by the total number of subsamples that
    were done (total number of times the regression was performed).</p>
<p>We made use of the <code>stabs</code> package that implements lasso stability
    selection, and adapted it to run randomized lasso stability selection.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>N. Meinshausen and P. Bühlmann (2010), Stability Selection,
    <em>Journal of the Royal Statistical Society: Series B
    (Statistical Methodology)</em>, <strong>72</strong>, 417–73. <br>
    R.D. Shah and R.J. Samworth (2013), Variable Selection with Error
   Control: Another Look at Stability Selection,
   <em>Journal of the Royal Statistical Society: Series B
   (Statistical Methodology)</em>, <strong>75</strong>, 55–80. <br>
    B. Hofner, L. Boccuto, and M. Göker (2015), Controlling False
    Discoveries in High-Dimensional Situations: Boosting with Stability
    Selection, <em>BMC Bioinformatics</em>, <strong>16</strong> 144.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## create data set</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">X</span><span class="op">[</span> ,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">s_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">s_cols</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">X</span><span class="op">[</span> ,<span class="va">s_cols</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span> ,<span class="va">s_cols</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">Y</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## reproducible randLassoStabSel() with 1 core</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu">randLassoStabSel</span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## reproducible randLassoStabSel() in parallel mode</span></span></span>
<span class="r-in"><span><span class="co">## (only works on non-windows machines)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">==</span> <span class="st">"unix"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">RNGkind</a></span><span class="op">(</span><span class="st">"L'Ecuyer-CMRG"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu">randLassoStabSel</span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">Y</span>, mc.preschedule <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                           mc.set.seed <span class="op">=</span> <span class="cn">TRUE</span>, mc.cores <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/machlabd" class="external-link">Dania Machlab</a>, <a href="https://github.com/LukasBurger" class="external-link">Lukas Burger</a>, <a href="https://github.com/csoneson" class="external-link">Charlotte Soneson</a>, <a href="https://github.com/mbstadler" class="external-link">Michael Stadler</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>


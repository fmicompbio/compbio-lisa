<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Randomized Lasso Stability Selection — randLassoStabSel • monaLisa</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Randomized Lasso Stability Selection — randLassoStabSel"><meta property="og:description" content="This function runs randomized lasso stability selection as
    presented by Meinshausen and Bühlmann (2010) and with the improved
    error bounds introduced by Shah and Samworth (2013). The function
    uses the stabsel function from the stabs
    package, but implements the randomized lasso version."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">monaLisa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.11.1</span>
      </span>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/monaLisa.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/selecting_motifs_with_randLassoStabSel.html">Regression Based Approach for Motif Selection</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/fmicompbio/monaLisa" class="external-link">
    <span class="fab fa-github fa-lg"></span>
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Randomized Lasso Stability Selection</h1>
    <small class="dont-index">Source: <a href="https://github.com/fmicompbio/monaLisa/blob/HEAD/R/stability_selection.R" class="external-link"><code>R/stability_selection.R</code></a></small>
    <div class="hidden name"><code>randLassoStabSel.Rd</code></div>
    </div>
    <div class="ref-description">
    <p>This function runs randomized lasso stability selection as
    presented by Meinshausen and Bühlmann (2010) and with the improved
    error bounds introduced by Shah and Samworth (2013). The function
    uses the <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code> function from the <code>stabs</code>
    package, but implements the randomized lasso version.</p>
    </div>
    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">randLassoStabSel</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  weakness <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  cutoff <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  PFER <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  mc.cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>
    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>the predictor matrix.</p></dd>
<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>the response vector.</p></dd>
<dt id="arg-weakness">weakness<a class="anchor" aria-label="anchor" href="#arg-weakness"></a></dt>
<dd><p>value between 0 and 1 (default = 0.8).
It affects how strict the method will be in selecting predictors. The
closer it is to 0, the more stringent the selection. A weakness value
of 1 is identical to performing lasso stability selection (not the
randomized version).</p></dd>
<dt id="arg-cutoff">cutoff<a class="anchor" aria-label="anchor" href="#arg-cutoff"></a></dt>
<dd><p>value between 0 and 1 (default = 0.8) which is the cutoff
for the selection probability. Any variable with a selection probability
that is higher than the set cutoff will be selected.</p></dd>
<dt id="arg-pfer">PFER<a class="anchor" aria-label="anchor" href="#arg-pfer"></a></dt>
<dd><p>integer (default = 2) representing the absolute number of
false positives that we allow for in the final list of selected
variables. For details see Meinshausen and Bühlmann (2010).</p></dd>
<dt id="arg-mc-cores">mc.cores<a class="anchor" aria-label="anchor" href="#arg-mc-cores"></a></dt>
<dd><p>integer (default = 1) specifying the number of cores to
use in <code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">mclapply</a></code>, which is the default way
<code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code> does parallelization.</p></dd>
<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional parameters that can be passed on to
<code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
<p>A <code>SummarizedExperiment</code> object where the rows are the
    observations and the columns the predictors (same dimnames as the
    predictor matrix <code>x</code>).
    It contains:</p><dl><dt>assays</dt>
<dd><p>:</p><dl><dt>x</dt>
<dd><p>: the predictor matrix.</p></dd>
</dl><p></p></dd>
      <dt>rowData</dt>
<dd><p>: a DataFrame with columns:</p><dl><dt>y</dt>
<dd><p>: the response vector.</p></dd>
</dl><p></p></dd>
      <dt>colData</dt>
<dd><p>: a DataFrame with columns:</p><dl><dt>selProb</dt>
<dd><p>: the final selection probabilities for the
          predictors (from the last regularization step).</p></dd>
        <dt>selected</dt>
<dd><p>: logical indicating the predictors that made
          the selection with the specified cutoff.</p></dd>
        <dt>selAUC</dt>
<dd><p>: the normalized area under the seletion curve
          (mean of selection probabilities over regulatization steps).</p></dd>
        <dt>reg'<code>i</code>'</dt>
<dd><p>: columns containing the selection
          probabilities for regularization step i.</p></dd>
</dl><p></p></dd>
      <dt>metadata</dt>
<dd><p>: a list of output returned from
        <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code> and <code>randLassoStabSel</code>:</p><dl><dt>stabsel.params.cutoff</dt>
<dd><p>: probability cutoff set for selection
          of predictors (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>
        <dt>stabsel.params.selected</dt>
<dd><p>: elements with maximal selection
          probability greater <code>cutoff</code>
          (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>
        <dt>stabsel.params.max</dt>
<dd><p>: maximum of selection probabilities
          (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>
        <dt>stabsel.params.q</dt>
<dd><p>: average number of selected variables
          used (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>
        <dt>stabsel.params.PFER</dt>
<dd><p>: (realized) upper bound for the
          per-family error rate (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>
        <dt>stabsel.params.specifiedPFER</dt>
<dd><p>: specified upper bound for
          the per-family error rate (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>
        <dt>stabsel.params.p</dt>
<dd><p>: the number of effects subject to
          selection (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>
        <dt>stabsel.params.B</dt>
<dd><p>: the number of subsamples (see
          <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>
        <dt>stabsel.params.sampling.type</dt>
<dd><p>: the sampling type used for
          stability selection (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>
        <dt>stabsel.params.assumption</dt>
<dd><p>: the assumptions made on the
          selection probabilities (see <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code>).</p></dd>
        <dt>stabsel.params.call</dt>
<dd><p>: <code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code> the call.</p></dd>
        <dt>randStabsel.params.weakness</dt>
<dd><p>: the weakness parameter in the
          randomized lasso stability selection.</p></dd>
</dl><p></p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Randomized lasso stability selection runs a randomized lasso
    regression several times on subsamples of the response variable and
    predictor matrix. N/2 elements from the response variable are randomly
    chosen in each regression, where N is the length of the vector. The
    corresponding section of the predictor matrix is also chosen, and the
    internal <code>.glmnetRandomizedLasso</code> function is applied.
    Stability selection results in selection probabilities for each
    predictor. The probability of a specific predictor is the number of
    times it was selected divided by the total number of subsamples that
    were done (total number of times the regression was performed).</p>
<p>We made use of the <code>stabs</code> package that implements lasso stability
    selection, and adapted it to run randomized lasso stability selection.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>N. Meinshausen and P. Bühlmann (2010), Stability Selection,
    <em>Journal of the Royal Statistical Society: Series B
    (Statistical Methodology)</em>, <strong>72</strong>, 417–73. <br>
    R.D. Shah and R.J. Samworth (2013), Variable Selection with Error
   Control: Another Look at Stability Selection,
   <em>Journal of the Royal Statistical Society: Series B
   (Statistical Methodology)</em>, <strong>75</strong>, 55–80. <br>
    B. Hofner, L. Boccuto, and M. Göker (2015), Controlling False
    Discoveries in High-Dimensional Situations: Boosting with Stability
    Selection, <em>BMC Bioinformatics</em>, <strong>16</strong> 144.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/stabs/man/stabsel.html" class="external-link">stabsel</a></code></p></div>
    </div>
    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## create data set</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">X</span><span class="op">[</span> ,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">s_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">s_cols</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">X</span><span class="op">[</span> ,<span class="va">s_cols</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span> ,<span class="va">s_cols</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">Y</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## reproducible randLassoStabSel() with 1 core</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu">randLassoStabSel</span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## reproducible randLassoStabSel() in parallel mode</span></span></span>
<span class="r-in"><span><span class="co">## (only works on non-windows machines)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">==</span> <span class="st">"unix"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">RNGkind</a></span><span class="op">(</span><span class="st">"L'Ecuyer-CMRG"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu">randLassoStabSel</span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">Y</span>, mc.preschedule <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                           mc.set.seed <span class="op">=</span> <span class="cn">TRUE</span>, mc.cores <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>
      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://github.com/machlabd" class="external-link">Dania Machlab</a>, <a href="https://github.com/LukasBurger" class="external-link">Lukas Burger</a>, <a href="https://github.com/csoneson" class="external-link">Charlotte Soneson</a>, <a href="https://github.com/mbstadler" class="external-link">Michael Stadler</a>.</p>
</div>
<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.9000.</p>
</div>
      </footer></div>
  </body></html>

